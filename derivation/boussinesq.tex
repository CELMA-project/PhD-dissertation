We will in this chapter modify the obtained equations by using the so-called Boussinesq approximation.
This approximation is also sometimes referred to as the local approximation.
The name Boussinesq approximation is a bit of a misnomer, as this actually refers to a series of approximations in fluid mechanics where the small variation in density is one of them \cite{Kundu2010book}.

The usage of this approximation in drift fluid equations is not always sound, as the criterion for the approximation is easily broken.
However, one argument to use the approximation is that one can make a set of equations which conserves energy without getting into the problem of having the polarization drift advecting itself (which leads to an infinite loop in the derivation).
% FIXME: Does it? Review why this is again

\section{The Boussinesq approximation in a slowly varying B-field}
\label{sec:boussinesq}
%
The goal of this approximation is to let $n$ commute with the gradient in \cref{eq:complVort}.
We start by splitting the density into a background profile $\overline{n}$ and the fluctuation $\delta_n$.
That is, we have
%
\begin{align*}
    n = \overline{n} + \delta_n,
\end{align*}
%
and we assume that $\overline{n} \gg \delta_n$.
%
Order of magnitude estimates now give
%
\begin{align*}
    &\grad \overline{n} \sim \frac{\overline{n}}{L_n}&
    %
    &\grad \delta_n
    =
    \grad_\perp \delta_n + \grad_\| \delta_n
    \sim \frac{\delta_n}{L_{\delta_n, \perp}} + \frac{\delta_n}{L_{\delta_n, \|}}
    \simeq \frac{\delta_n}{L_{\delta_n, \perp}},
    &
\end{align*}
%
where we have assumed that $L_{\delta_n, \perp} \ll L_{\delta_n, \|}$.

If we now normalize the densities with $n_0$ and the gradients with $\rho_s$, and write the normalized units with a breve ( $ \breve{ } $ ), we find that
%
\begin{align*}
    \breve{\grad} \breve{\overline{n}}
    \sim& \frac{\frac{\overline{n}}{n_0}}{\frac{L_n}{\rho_s}}
    = \frac{\overline{n}}{L_n}\frac{\rho_s}{n_0}
    \simeq \frac{\rho_s}{L_n}.
    \note{$\frac{\overline{n}}{n_0} \simeq 1$}
\end{align*}
%
By assuming that $\frac{\rho_s}{L_n}\ll1$%
%
\footnote{Note that for the perpendicular velocities in \cref{app:DO}, we assumed that $\frac{\rho_s}{L_{\ve{u}_\perp}}\sim\sqrt{\e}$} %
%
(meaning that the density gradient length scales are much larger than $\rho_s$), we find that
%
\begin{align*}
    \breve{\grad} \breve{\overline{n}} \ll 1.
\end{align*}
%
% FIXME: Consider adding how this relates to experimental findings. Could even compare them to computational! Just looking at plots, see that Ln > rho_s, but maybe not L_n >> rho_s
%
Further on, we have that
%
\begin{align*}
    \breve{\grad} \breve{\delta_n}
    \sim& \frac{\frac{\delta_n}{n_0}}{\frac{L_{\delta_n}}{\rho_s}}
    = \frac{\delta_n}{L_{\delta_n, \perp}}\frac{\rho_s}{n_0}.
\end{align*}
%
From our assumption about small perturbations, we know that $\frac{\delta_n}{n_0}\ll 1$.
If we assume that $\frac{\rho_s}{L_{\delta_n, \perp}} \not\gg 1$.
Then
%
\begin{align*}
    \breve{\grad} \breve{\delta_n} \ll 1.
\end{align*}
%
In other words, we have that
%
\begin{align*}
    \grad(fn) \simeq n\grad f.
\end{align*}
%
Using the assumptions, we find that inserting this in \cref{eq:start_of_boussinesq} yields
%
\begin{align*}
 \div\L( n \frac{1}{\om_{ci}}
  \L[ \d_t^E + \ve{u}_{i,\|}\cdot\nabla \R]
  \L[ \frac{\grad_\perp \phi}{B} \R]
 \R)
 =&
 n\div\L(\frac{1}{\om_{ci}}
  \L[ \d_t^E + \ve{u}_{i,\|}\cdot\nabla \R]
  \L[ \frac{\grad_\perp \phi}{B} \R]
 \R)
 \\&+
 \L(\frac{1}{\om_{ci}}
  \L[ \d_t^E + \ve{u}_{i,\|}\cdot\nabla \R]
  \L[ \frac{\grad_\perp \phi}{B} \R]
 \R)
 \cdot\grad n
 \\
 %
 \simeq&
 \L(\overline{n} + \delta_n\R)
 \div\L(\frac{1}{\om_{ci}}
  \L[ \d_t^E + \ve{u}_{i,\|}\cdot\nabla \R]
  \L[ \frac{\grad_\perp \phi}{B} \R]
 \R)
 \note{$\overline{n} \gg \delta_n$}
 \\
  %
 \simeq&
 \overline{n}\div\L(
  \frac{1}{\om_{ci}}
  \L[ \d_t^E + \ve{u}_{i,\|}\cdot\nabla \R]
  \L[ \frac{\grad_\perp \phi}{B} \R]
 \R).
\end{align*}
%
Finally, we will assume a relatively flat density background profile, so that $n_0 \simeq \overline{n}$.
This means that \cref{eq:start_of_boussinesq} with the Boussinesq approximation yields
%
\begin{align*}
 \div\L( n
  \frac{1}{\om_{ci}}
  \L[ \d_t^E + \ve{u}_{i,\|})\cdot\nabla \R]
  \L[ - \frac{\grad_\perp \phi}{B} \R] \R)
 \simeq&
 n_0\div\L(
  \frac{1}{\om_{ci}}
  \L[ \d_t^E + \ve{u}_{i,\|}\cdot\nabla \R]
  \L[ \frac{\grad_\perp \phi}{B} \R]
 \R)
  \\
  %
  =&
 - n_0 \div\L(
    \frac{1}{\om_{ci}}
     \d_t^E \L[ \frac{\grad_\perp \phi}{B} \R] \R)
 - n_0 \div\L(
    \frac{1}{\om_{ci}}
     \ve{u}_{i,\|}\cdot\nabla
 \L[ \frac{\grad_\perp \phi}{B} \R]
 \R)
 %
 \\
 =&
 - n_0 \div\L(
    \frac{1}{\om_{ci}}
     \d_t^E \L[ \frac{\grad_\perp \phi}{B} \R] \R)
 - n_0 \div\L(
    \frac{1}{\om_{ci}}
     u_{i,\|}\partial_\|
 \L[ \frac{\grad_\perp \phi}{B} \R] \R).
\numberthis
\label{eq:boussinesq_vort}
\end{align*}
%
Let us now briefly comment on the approximations made
%
% Consider: More cites
\begin{enumerate}[noitemsep]
    \item $\overline{n} \gg \delta_n$ : This approximation can be broken as the perturbation amplitudes can be large as seen in \cref{chap:charTurb}.
    \item $\frac{\rho_s}{L_n}\ll1$ : This approximation usually holds as the gradient scale length in the background density are long compared to $\rho_s$.
        However, they are not necessarily orders of magnitude larger.
    \item $\overline{n} \simeq n_0$ : This assumption is maybe the hardest to fulfill, as the gradients are usually non-vanishing.
\end{enumerate}
%
We see that although the assumptions can be met, they are not generally true.
As this approximation is done quite frequently in the literature, it is of interest to compare results with and without this approximation.
This will be presented in \cref{chap:compBouss}.

In the scope of this thesis, we will only do the approximation in the polarization term of the vorticity equation, and keep gradients of $n$ elsewhere.
A more rigorous study could be to investigate the set of equations from an energy conservation point of view, and from that find out which of the $n$'s in the set of equations that should be transformed to $n_0$.

\section{The Boussinesq approximation in the CELMA model}
%
We will now see how the set of equations in the CELMA model is affected by the Boussinesq approximation.
Continuing from \cref{eq:boussinesq_vort}, using that $\grad B = 0$, we get
%
\begin{align*}
    &- n_0 \div\L(
       \frac{1}{\om_{ci}}
        \d_t^E \L[ \frac{\grad_\perp \phi}{B} \R] \R)
    - n_0 \div\L(
       \frac{1}{\om_{ci}}
        u_{i,\|}\partial_\|
    \L[ \frac{\grad_\perp \phi}{B} \R] \R)
    \\
    =&
    - \frac{n_0}{\om_{ci}}
    \L( \div\L[ \d_t^E \L( \frac{\grad_\perp \phi}{B} \R) \R]
     + \div\L[ u_{i,\|}\partial_\| \L( \frac{\grad_\perp \phi}{B} \R) \R] \R)
     \\
     %
     =&
     - \frac{n_0}{\om_{ci}}
     \L( \div\L[ \L(\partial_t
     + \ve{u}_E\cdot\grad\R) \L( \frac{\grad_\perp \phi}{B} \R) \R]
     + \div\L[ u_{i,\|}\partial_\| \L( \frac{\grad_\perp \phi}{B} \R) \R] \R)
     \note{Assume interchangibility of spatial and temporal derivatives}
     \\
     %
     =&
     - \frac{n_0}{\om_{ci}}
     \L( \div \partial_t\L( \frac{\grad_\perp \phi}{B} \R)
     + \div \L(\ve{u}_E\cdot\grad \frac{\grad_\perp \phi}{B} \R)
     + \div\L[ u_{i,\|}\partial_\| \L( \frac{\grad_\perp \phi}{B} \R) \R] \R)
     \\
     %
     =&
     - \frac{n_0}{\om_{ci}}\partial_t\Om
     - \frac{n_0}{\om_{ci}}
     \L(
     \div \L[\ve{u}_E\cdot\grad \frac{\grad_\perp \phi}{B} \R]
     + \div\L[ u_{i,\|}\partial_\| \L( \frac{\grad_\perp \phi}{B} \R) \R] \R)
     \note{$\partial_\|=0$}
     \\
     %
     =&
     - \frac{n_0}{\om_{ci}}\partial_t\Om
     - \frac{n_0}{\om_{ci}}
     \L(
     \div \L[\ve{u}_E\cdot\grad \frac{\grad_\perp \phi}{B} \R]
     + u_{i,\|}\partial_\|\Om
     + \frac{\grad_\perp\L( \partial_\|\phi\R)}{B}\cdot\grad u_{i,\|}
     \R).
\end{align*}
%
Following the derivation in \cref{app:vortDAdv} (but this time without $n$) we see that in cylinder geometry
%
\begin{align*}
    \div \L[\ve{u}_E\cdot\grad \frac{\grad_\perp \phi}{B} \R]
    = \frac{1}{B\rho}\{\phi, \Om\},
\end{align*}
%
so that
%
\begin{align*}
 \div\L( n
  \frac{1}{\om_{ci}}
  \L[ \d_t^E + \ve{u}_{i,\|})\cdot\nabla \R]
  \L[ - \frac{\grad_\perp \phi}{B} \R] \R)
  \simeq&
  - \frac{n_0}{\om_{ci}}\partial_t\Om
  - \frac{n_0}{\om_{ci}}
  \L(
  \frac{1}{B\rho}\{\phi, \Om\}
  + u_{i,\|}\partial_\|\Om
  + \frac{\grad_\perp\L( \partial_\|\phi\R)}{B}\cdot\grad u_{i,\|}
  \R).
\end{align*}
%
If we now collect the terms as we did in \cref{eq:non_norm_vort_1}, we get
%
\begin{align*}
  %
  &
  \quad
 \frac{\nu_{in}}{\om_{ci}} \L(n\Om + \frac{\grad_\perp \phi}{B} \cdot \grad n\R)
  \\
 &
 + \frac{n_0}{\om_{ci}}\partial_t\Om
 + \frac{n_0}{\om_{ci}}
 \L(
 \frac{1}{B\rho}\{\phi, \Om\}
 + u_{i,\|}\partial_\|\Om
 + \frac{\grad_\perp\L( \partial_\|\phi\R)}{B}\cdot\grad u_{i,\|}
 \R)
 \\
 %
 &
 + \frac{1}{\om_{ci}}
    \div \L( S_n \L[ \frac{ \grad_\perp \phi }{ B } \R] \R)
 \\
 %
 =&
 \partial_\| j_\|,
\end{align*}
%
which after rearranging yields
%
\begin{align*}
  %
 \frac{n_0}{\om_{ci}}\partial_t\Om
 %
 =&
 - \frac{\nu_{in}}{\om_{ci}} \L(n\Om + \frac{\grad_\perp \phi}{B} \cdot \grad n\R)
  \\
  %
 &- \frac{n_0}{\om_{ci}}
 \L( \frac{1}{B\rho}\{\phi, \Om\}
    + u_{i,\|}\partial_\|\Om
    + \frac{\grad_\perp\L( \partial_\|\phi\R)}{B}\cdot\grad u_{i,\|}
 \R)
 \\
 %
 &
 - \frac{1}{\om_{ci}}
    \div \L( S_n \L[ \frac{ \grad_\perp \phi }{ B } \R] \R)
 \\
 %
 &
 + \partial_\| j_\|.
\end{align*}
%
We note that as we have no time derivative of $n$, the source term does not cancel as it did without this approximation.
%

\section{Normalization}
Finally, normalization yields
%
\begin{align*}
 \frac{n_0}{\om_{ci}}\omega_{ci}^2\partial_t\Om
 %
 =&
 - \frac{\om_{ci}\nu_{in}}{\om_{ci}}
 \L(n_0\om_{ci}n\Om
 + \frac{c_s}{\rho_s}n_0\frac{\grad_\perp \phi}{B} \cdot \grad n\R)
  \\
  %
 &- \frac{n_0}{\om_{ci}}
 \L(\frac{1}{\rho_s} c_s \om_{ci}\frac{1}{B\rho}\{\phi, \Om\}
    + c_s \frac{1}{\rho_s}\omega_{ci}u_{i,\|}\partial_\|\Om
    + \frac{1}{\rho_s}c_s\frac{1}{\rho_s}c_s
    \frac{\grad_\perp\L( \partial_\|\phi\R)}{B}\cdot\grad u_{i,\|}
 \R)
 \\
 %
 &
 - \frac{1}{\om_{ci}}\frac{1}{\rho_s}n_0\omega_{ci}c_s
    \div \L( S_n \L[ \frac{ \grad_\perp \phi }{ B } \R] \R)
 \\
 %
 &
 + \frac{1}{\rho_s}n_0c_s\partial_\| j_\|
 \\
 %
 %
 %
 n_0\omega_{ci}\partial_t\Om
 %
 =&
 - \nu_{in}
 \L(n_0\om_{ci}n\Om
 + \om_{ci}n_0\frac{\grad_\perp \phi}{B} \cdot \grad n\R)
  \\
  %
 &- \frac{n_0}{\om_{ci}}
 \L(\om_{ci}^2\frac{1}{B\rho}\{\phi, \Om\}
    + \omega_{ci}^2u_{i,\|}\partial_\|\Om
    + \omega_{ci}^2
    \frac{\grad_\perp\L( \partial_\|\phi\R)}{B}\cdot\grad u_{i,\|}
 \R)
 \\
 %
 &
 - n_0\omega_{ci}
    \div \L( S_n \L[ \frac{ \grad_\perp \phi }{ B } \R] \R)
 \\
 %
 &
 + \omega_{ci}n_0\partial_\| j_\|
 \\
 %
 %
 %
 \partial_t\Om
 %
 =&
 - \nu_{in}
 \L(n\Om
 + \frac{\grad_\perp \phi}{B} \cdot \grad n\R)
  \\
  %
 &-
 \L(\frac{1}{B\rho}\{\phi, \Om\}
    + u_{i,\|}\partial_\|\Om
    +\frac{\grad_\perp\L( \partial_\|\phi\R)}{B}\cdot\grad u_{i,\|}
 \R)
 \\
 %
 &
 - \div \L( S_n \L[ \frac{ \grad_\perp \phi }{ B } \R] \R)
 \\
 %
 &
 + \partial_\| j_\|.
\end{align*}

\section{The vorticity equation}
%
By using the Boussinesq approximation, we will evolve the vorticity $\Om$ in time rather than the modified vorticity $\Om^D$, and get%
\footnote{As in \cref{sec:SOE} the artificial viscosities are not shown here, but they are used in the simulations.}
%
\begin{empheq}[box={\tcbhighmath}]{align*}
 \partial_t\Om
 %
 =&
 - \nu_{in}
 \L(n\Om
 + \frac{\grad_\perp \phi}{B} \cdot \grad n\R)
  \\
  %
 &-
 \L(\frac{1}{B\rho}\{\phi, \Om\}
    + u_{i,\|}\partial_\|\Om
    +\frac{\grad_\perp\L( \partial_\|\phi\R)}{B}\cdot\grad u_{i,\|}
 \R)
 \\
 %
 &
 - \div \L( S_n \L[ \frac{ \grad_\perp \phi }{ B } \R] \R)
 \\
 %
 &
 + \partial_\| j_\|
  \numberthis
  \label{eq:celma_vort_boussinesq}
\end{empheq}
%
To see how good or bad this approximation is (at least in our system), we will compare it with results not using this approximation in \cref{part:results}.
